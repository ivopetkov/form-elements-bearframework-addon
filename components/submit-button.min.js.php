<?php

/*
 * Form elements addon for Bear Framework
 * https://github.com/ivopetkov/form-elements-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
for(var elements=document.body.querySelectorAll("[data-form-element-type='submit-button']"),i=0;i<elements.length;i++)!function(e){if(void 0===e.dataFormElementAPISet){e.dataFormElementAPISet=!0;var t=e.querySelector('[data-form-element-component="button"]');t.addEventListener("keydown",(function(e){13===e.keyCode&&(t.click(),e.preventDefault(),e.stopPropagation())})),e.focus=function(){var t=e.getFocusTarget();null!==t&&t.focus()},e.getFocusTarget=function(){return t}}}(elements[i]);var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.formElementsSubmitButton=ivoPetkov.bearFrameworkAddons.formElementsSubmitButton||{onClick:function(e,t,r,o){for(var n=e;n&&"form"!==n.tagName.toLowerCase();)n=n.parentNode;if(n&&(void 0===e.disableNextClick||!e.disableNextClick)){var i=n,s=()=>{e.disableNextClick=!0,void 0===e.originalInnerText&&(e.originalInnerText=e.innerText),void 0===e.originalClass&&(e.originalClass=e.getAttribute("class")),r.length>0&&e.setAttribute("class",r),t.length>0&&(e.innerText=t),e.setAttribute("disabled","true"),e.style.cursor="default"},a=t=>{i.removeEventListener("submitstart",s),i.removeEventListener("submitsuccess",l),i.removeEventListener("submiterror",u),t&&!o||(e.disableNextClick=!1,e.innerText=e.originalInnerText,e.removeAttribute("disabled"),e.style.cursor="pointer",null!==e.originalClass&&e.setAttribute("class",e.originalClass))},l=()=>{a(!0)},u=()=>{a(!1)};i.addEventListener("submitstart",s),i.addEventListener("submitsuccess",l),i.addEventListener("submiterror",u),i.submit()}}};
EOT;
