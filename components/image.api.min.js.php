<?php

/*
 * Form elements addon for Bear Framework
 * https://github.com/ivopetkov/form-elements-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
for(var elements=document.body.querySelectorAll("[data-form-element-type='image']"),i=0;i<elements.length;i++)(function(b){if("undefined"===typeof b.dataFormAPISet){b.dataFormAPISet=!0;b.getValue=function(){};b.setValue=function(a){};b.setVisibility=function(a){b.setAttribute("data-form-element-visibility",a?"1":"0")};var c=b.querySelector("[data-form-element-component='clear-button']"),d=c.nextSibling,h=b.querySelectorAll("input"),e=h[0],f=h[1],g=function(){if(0===e.files.length)d.style.backgroundImage="",d.firstChild.innerText=0===f.value.length?"CHOOSE_TEXT_TO_REPLACE":"",c.style.display="none";else{d.firstChild.innerText="";c.style.display="inline-block";var a=new FileReader;a.addEventListener("load",function(){d.style.backgroundImage="url("+a.result+")"},!1);a.readAsDataURL(e.files[0])}};c.addEventListener("click",function(a){a.stopPropagation();a.preventDefault();e.value="";f.value="";g()},!1);e.addEventListener("change",g,!1);f.addEventListener("change",g,!1)}})(elements[i]);
EOT;
